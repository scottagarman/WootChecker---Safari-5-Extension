<!DOCTYPE html>
<html>
<head>
<title>WootChecker</title>
<link rel="stylesheet" href="styles/main.css" type="text/css"/>
<script type="text/javascript">
	const myGlobal = safari.extension.globalPage.contentWindow;
	var mData = null;
	
	function onLoad(){
		myGlobal.getFeed();
	}
	function updateContent(data){
		//alert("data: " + data.itemPrice + " // " + data.itemName);
		mData = data;
		
		if(mData.isWootOff == "True"){
			//do woot off stuff???
		}
		
		(mData.isSoldOut == "True") ? document.getElementById("soldOut").style.display = "block" : document.getElementById("soldOut").display = "none";
		document.getElementById("price").innerHTML = '<a href="javascript:void(0)">'+mData.itemPrice+'</a>';
		document.getElementById("name").innerHTML = '<a href="javascript:void(0)">'+mData.itemName+'</a>';
		document.getElementById("chatB").value = "Discussion(" + mData.comments + ")";
		document.getElementById("name").title = mData.teaser; 
		
	}
	
	function linkBuy(){
		var newTab = safari.self.browserWindow.openTab();
		newTab.url = mData.buyLink;
	}
	function linkChat(){
		var newTab = safari.self.browserWindow.openTab();
		newTab.url = mData.chatLink;	
	}
	function openWoot(){
		var newTab = safari.self.browserWindow.openTab();
		newTab.url = "http://www.woot.com";	
	}
</script>
</head>
<body onload="onLoad();">
<div id="content">
	<!-- Left Text -->	
	<div id="icon" class="lItem"><img src="/img/favicon.ico" onclick="openWoot();"/></div>
	<div id="soldOut" class="lItem" onclick="openWoot();">Sold Out!</div>
	<div id="price" class="lItem" onclick="openWoot();">Loading...</div>
	<div id="name" class="lItem" onclick="openWoot();"></div>
	<!-- Right Buttons -->	
	<div id="chat" class="rItem"><input id="chatB" type="button" value="Discussion" onclick="linkChat();"></div>
	<div id="buy" class="rItem"><input id="buyB" type="button" value="I want one!" onclick="linkBuy();"></div>
</div>
</body>
</html>